# API –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (–∞–∫—Ü–∏–∏, —Ñ—å—é—á–µ—Ä—Å—ã, –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã) –≤ –ø–∞–º—è—Ç—å –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—ç—à–µ–º.

## –¢–∏–ø—ã –∫—ç—à–µ–π

| –ö—ç—à | –û–ø–∏—Å–∞–Ω–∏–µ | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ |
|-----|----------|------------|
| `sharesCache` | –ö—ç—à –∞–∫—Ü–∏–π | –í—Å–µ –∞–∫—Ü–∏–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã shares |
| `futuresCache` | –ö—ç—à —Ñ—å—é—á–µ—Ä—Å–æ–≤ | –í—Å–µ —Ñ—å—é—á–µ—Ä—Å—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã futures |
| `indicativesCache` | –ö—ç—à –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ | –í—Å–µ –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã indicatives |
| `limitsCache` | –ö—ç—à –ª–∏–º–∏—Ç–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ | –õ–∏–º–∏—Ç—ã (–≤–µ—Ä—Ö–Ω–∏–µ –∏ –Ω–∏–∂–Ω–∏–µ) –¥–ª—è –∞–∫—Ü–∏–π –∏ —Ñ—å—é—á–µ—Ä—Å–æ–≤ |
| `notificationsCache` | –ö—ç—à —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –ª–∏–º–∏—Ç–∞—Ö | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ |

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫—ç—à–∞

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä**: 10,000 –∑–∞–ø–∏—Å–µ–π –Ω–∞ –∫—ç—à
- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏**: 24 —á–∞—Å–∞
- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –ø–æ—Å–ª–µ –¥–æ—Å—Ç—É–ø–∞**: 12 —á–∞—Å–æ–≤
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: Caffeine Cache

## API Endpoints

### 1. –ü—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞

–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤ –∫—ç—à.

**Endpoint:** `POST /api/cache/warmup`

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl -X POST http://localhost:8080/api/cache/warmup
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "success": true,
  "message": "–ö—ç—à —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–≥—Ä–µ—Ç",
  "timestamp": "2024-10-21T10:30:00.123"
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

### 2. –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∫—ç—à–∞

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º –∫—ç—à–µ–π.

**Endpoint:** `GET /api/cache/content`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `cacheName` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∏–º—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫—ç—à–∞
- `limit` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 100) - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**

1. –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∫—ç—à–µ–π:
```bash
curl http://localhost:8080/api/cache/content
```

2. –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫—ç—à–∞:
```bash
curl http://localhost:8080/api/cache/content?cacheName=sharesCache
```

3. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π:
```bash
curl http://localhost:8080/api/cache/content?cacheName=futuresCache&limit=50
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "timestamp": "2024-10-21T10:30:00.123",
  "caches": {
    "sharesCache": {
      "name": "sharesCache",
      "nativeCache": "BoundedLocalCache",
      "entryCount": 1000,
      "sampleLimit": 100,
      "statistics": {
        "hitCount": 15000,
        "missCount": 100,
        "hitRate": 0.9934,
        "evictionCount": 0,
        "loadSuccessCount": 100,
        "loadFailureCount": 0
      },
      "sampleEntries": [
        {
          "key": "all",
          "valueType": "ArrayList",
          "valueSize": 1000
        }
      ]
    },
    "futuresCache": {
      "name": "futuresCache",
      "nativeCache": "BoundedLocalCache",
      "entryCount": 300,
      "sampleLimit": 100,
      "statistics": {
        "hitCount": 5000,
        "missCount": 50,
        "hitRate": 0.9901,
        "evictionCount": 0,
        "loadSuccessCount": 50,
        "loadFailureCount": 0
      },
      "sampleEntries": [
        {
          "key": "all",
          "valueType": "ArrayList",
          "valueSize": 300
        }
      ]
    },
    "indicativesCache": {
      "name": "indicativesCache",
      "nativeCache": "BoundedLocalCache",
      "entryCount": 200,
      "sampleLimit": 100,
      "statistics": {
        "hitCount": 3000,
        "missCount": 30,
        "hitRate": 0.9901,
        "evictionCount": 0,
        "loadSuccessCount": 30,
        "loadFailureCount": 0
      },
      "sampleEntries": [
        {
          "key": "all",
          "valueType": "ArrayList",
          "valueSize": 200
        }
      ]
    }
  }
}
```

---

### 3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–≤–æ–¥–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤—Å–µ–º –∫—ç—à–∞–º.

**Endpoint:** `GET /api/cache/stats`

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl http://localhost:8080/api/cache/stats
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "timestamp": "2024-10-21T10:30:00.123",
  "totalCaches": 3,
  "activeCaches": 3,
  "totalEntries": 1500,
  "cacheDetails": {
    "sharesCache": {
      "name": "sharesCache",
      "entryCount": 1000,
      "statistics": {
        "hitCount": 15000,
        "missCount": 100,
        "hitRate": 0.9934,
        "evictionCount": 0
      }
    },
    "futuresCache": {
      "name": "futuresCache",
      "entryCount": 300,
      "statistics": {
        "hitCount": 5000,
        "missCount": 50,
        "hitRate": 0.9901,
        "evictionCount": 0
      }
    },
    "indicativesCache": {
      "name": "indicativesCache",
      "entryCount": 200,
      "statistics": {
        "hitCount": 3000,
        "missCount": 30,
        "hitRate": 0.9901,
        "evictionCount": 0
      }
    }
  }
}
```

**–ú–µ—Ç—Ä–∏–∫–∏:**
- `hitCount` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –∫—ç—à—É
- `missCount` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–º–∞—Ö–æ–≤ –∫—ç—à–∞
- `hitRate` - –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ø–∞–¥–∞–Ω–∏–π (hitCount / (hitCount + missCount))
- `evictionCount` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—Ç–µ—Å–Ω–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- `loadSuccessCount` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫ –∏–∑ –ë–î
- `loadFailureCount` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫

---

### 4. –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞

–û—á–∏—â–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –≤—Å–µ—Ö –∫—ç—à–µ–π.

**Endpoint:** `DELETE /api/cache/clear`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `cacheName` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∏–º—è –∫—ç—à–∞ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**

1. –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∫—ç—à–∏:
```bash
curl -X DELETE http://localhost:8080/api/cache/clear
```

2. –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫—ç—à:
```bash
curl -X DELETE http://localhost:8080/api/cache/clear?cacheName=sharesCache
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (–≤—Å–µ –∫—ç—à–∏):**
```json
{
  "success": true,
  "message": "–í—Å–µ –∫—ç—à–∏ —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω—ã",
  "timestamp": "2024-10-21T10:30:00.123",
  "clearedCaches": [
    "sharesCache",
    "futuresCache",
    "indicativesCache"
  ]
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (–æ–¥–∏–Ω –∫—ç—à):**
```json
{
  "success": true,
  "message": "–ö—ç—à 'sharesCache' —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω",
  "timestamp": "2024-10-21T10:30:00.123",
  "clearedCache": "sharesCache"
}
```

---

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞

–ö—ç—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≥—Ä–µ–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

1. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç
2. `CacheWarmupService` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
3. –ú–µ—Ç–æ–¥ `@PostConstruct warmupCacheOnStartup()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
4. –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
   - –ê–∫—Ü–∏–∏
   - –§—å—é—á–µ—Ä—Å—ã
   - –ò–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
5. –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ª–∏–º–∏—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ü–∏–π –∏ —Ñ—å—é—á–µ—Ä—Å–æ–≤ –≤ `limitsCache`
6. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫—ç—à–∞—Ö
7. –í –ª–æ–≥–∞—Ö –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–≥—Ä—É–∑–∫–µ

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:**
```
INFO  CacheWarmupService - –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤...
INFO  CacheWarmupService - –ó–∞–≥—Ä—É–∂–µ–Ω–æ 1000 –∞–∫—Ü–∏–π –≤ –∫—ç—à
INFO  CacheWarmupService - –ó–∞–≥—Ä—É–∂–µ–Ω–æ 300 —Ñ—å—é—á–µ—Ä—Å–æ–≤ –≤ –∫—ç—à
INFO  CacheWarmupService - –ó–∞–≥—Ä—É–∂–µ–Ω–æ 200 –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –∫—ç—à
INFO  CacheWarmupService - üî• –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞ –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è 1000 –∞–∫—Ü–∏–π –∏ 300 —Ñ—å—é—á–µ—Ä—Å–æ–≤
INFO  CacheWarmupService - –ü—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞ –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ 1234 –º—Å. –í—Å–µ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤: 1500
```

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –ª–∏–º–∏—Ç–æ–≤

–ö—ç—à –ª–∏–º–∏—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é:

- **14:00 –ø–æ —Ä–∞–±–æ—á–∏–º –¥–Ω—è–º** (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-–ø—è—Ç–Ω–∏—Ü–∞, –º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è)
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –ª–∏–º–∏—Ç–æ–≤ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –¥–Ω—è
  - –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤

- **19:00 –ø–æ —Ä–∞–±–æ—á–∏–º –¥–Ω—è–º** (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-–ø—è—Ç–Ω–∏—Ü–∞, –º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è)
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –ª–∏–º–∏—Ç–æ–≤ –ø–µ—Ä–µ–¥ –≤–µ—á–µ—Ä–Ω–µ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–µ–π
  - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –≤–µ—á–µ—Ä–Ω–µ–π —Ç–æ—Ä–≥–æ–≤–ª–µ

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏:**
```
INFO  LimitMonitoringScheduler - üîÑ [14:00] –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –ª–∏–º–∏—Ç–æ–≤
INFO  LimitsService - üîÑ –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤...
INFO  LimitsService - üìà –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è –∞–∫—Ü–∏–π...
INFO  LimitsService - üìà –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è —Ñ—å—é—á–µ—Ä—Å–æ–≤...
INFO  LimitsService - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –ª–∏–º–∏—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞ 2341 –º—Å. –£—Å–ø–µ—à–Ω–æ: 1200, –û—à–∏–±–æ–∫: 5, –ü—Ä–æ–ø—É—â–µ–Ω–æ: 0
INFO  LimitMonitoringScheduler - === –†–ï–ó–£–õ–¨–¢–ê–¢–´ –û–ë–ù–û–í–õ–ï–ù–ò–Ø –ö–≠–®–ê –õ–ò–ú–ò–¢–û–í [14:00] ===
INFO  LimitMonitoringScheduler - ‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ: 1200
INFO  LimitMonitoringScheduler - ‚ùå –û—à–∏–±–æ–∫: 5
INFO  LimitMonitoringScheduler - ‚è≠Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–æ: 0
INFO  LimitMonitoringScheduler - ‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 2341 –º—Å
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞ –≤ –∫–æ–¥–µ

### –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫—ç—à–∞

```java
@Service
public class MyService {
    
    @Autowired
    private CacheWarmupService cacheWarmupService;
    
    public List<ShareEntity> getShares() {
        // –î–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ –∫—ç—à–∞, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
        // –ò–Ω–∞—á–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –ë–î –∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è
        return cacheWarmupService.getAllShares();
    }
    
    public List<FutureEntity> getFutures() {
        return cacheWarmupService.getAllFutures();
    }
    
    public List<IndicativeEntity> getIndicatives() {
        return cacheWarmupService.getAllIndicatives();
    }
}
```

### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ

```java
@Service
public class MyService {
    
    @Autowired
    private CacheWarmupService cacheWarmupService;
    
    public void clearAllCaches() {
        cacheWarmupService.evictAllCaches();
    }
    
    public void clearSharesCache() {
        cacheWarmupService.evictSharesCache();
    }
    
    public void clearFuturesCache() {
        cacheWarmupService.evictFuturesCache();
    }
    
    public void clearIndicativesCache() {
        cacheWarmupService.evictIndicativesCache();
    }
}
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫—ç—à–∞

1. –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
```bash
curl http://localhost:8080/api/cache/stats
```

2. –û–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –º–µ—Ç—Ä–∏–∫–∏:
   - **hitRate** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å > 0.95 (95%+) –¥–ª—è —Ö–æ—Ä–æ—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - **evictionCount** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º
   - **missCount** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∏–∑–∫–∏–º

3. –ï—Å–ª–∏ hitRate –Ω–∏–∑–∫–∏–π:
   - –£–≤–µ–ª–∏—á–∏—Ç—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞ –≤ `CacheConfig`
   - –£–≤–µ–ª–∏—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫—ç—à–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞

### –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–ù–µ –æ—á–∏—â–∞–π—Ç–µ –∫—ç—à –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏** - –∫—ç—à –ø—Ä–æ–≥—Ä–µ–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
2. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ hitRate** - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã—Å–æ–∫–∏–º (>95%)
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä—É—á–Ω–æ–π –ø—Ä–æ–≥—Ä–µ–≤** —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞–∑–º–µ—Ä –∫—ç—à–∞** –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–±—ä–µ–º–æ–º –¥–∞–Ω–Ω—ã—Ö
5. **–õ–æ–≥–∏—Ä—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** —Å –∫—ç—à–µ–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫—ç—à–∞ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `CacheConfig.java`:

```java
@Bean
public CacheManager cacheManager() {
    CaffeineCacheManager cacheManager = new CaffeineCacheManager(
        "sharesCache", 
        "futuresCache", 
        "indicativesCache",
        "limitsCache",
        "notificationsCache"
    );
    
    cacheManager.setCaffeine(Caffeine.newBuilder()
        .maximumSize(10_000)                    // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä
        .expireAfterWrite(24, TimeUnit.HOURS)   // –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏
        .expireAfterAccess(12, TimeUnit.HOURS)  // –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –ø–æ—Å–ª–µ –¥–æ—Å—Ç—É–ø–∞
        .recordStats()                          // –ó–∞–ø–∏—Å—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    );
    
    return cacheManager;
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –ª–∏–º–∏—Ç–æ–≤

–î–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞ –ª–∏–º–∏—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LimitsService`:

```java
@Service
public class MyService {
    
    @Autowired
    private LimitsService limitsService;
    
    public void refreshLimits() {
        Map<String, Integer> stats = limitsService.refreshLimitsCache();
        logger.info("–û–±–Ω–æ–≤–ª–µ–Ω–æ: {}, –û—à–∏–±–æ–∫: {}", 
            stats.get("successCount"), 
            stats.get("errorCount"));
    }
}
```

---

## Troubleshooting

### –ö—ç—à –Ω–µ –ø—Ä–æ–≥—Ä–µ–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–æ–≥–∏ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `@EnableCaching` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ `CacheConfig`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `CacheWarmupService` –∏–º–µ–µ—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏—é `@Service`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

### –ù–∏–∑–∫–∏–π hitRate

**–ü—Ä–æ–±–ª–µ–º–∞:** hitRate < 0.90

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–≤–µ–ª–∏—á—å—Ç–µ `expireAfterAccess` –≤ `CacheConfig`
2. –£–≤–µ–ª–∏—á—å—Ç–µ `maximumSize`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è –ª–∏ –∫—ç—à —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ

### OutOfMemoryError

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π –ø–∞–º—è—Ç–∏.

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–º–µ–Ω—å—à–∏—Ç–µ `maximumSize` –≤ `CacheConfig`
2. –£–º–µ–Ω—å—à–∏—Ç–µ `expireAfterWrite` –∏ `expireAfterAccess`
3. –£–≤–µ–ª–∏—á—å—Ç–µ heap memory –¥–ª—è JVM: `-Xmx2g`

---

## –°—Å—ã–ª–∫–∏

- [Caffeine Cache Documentation](https://github.com/ben-manes/caffeine)
- [Spring Cache Abstraction](https://docs.spring.io/spring-framework/docs/current/reference/html/integration.html#cache)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å–∞](MONITORING_GUIDE.md)

